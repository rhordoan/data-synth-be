# Asset Management Platform - Backend

This document serves as the official README for the backend services of the AI-powered Asset Management Platform. The backend is responsible for all data processing, business logic, synthetic data generation, and API endpoints that power the user-facing application.

## 1. Introduction

The backend for the Asset Management Platform is a high-performance, scalable, and secure service designed to handle all aspects of asset, ownership, and patch management. Built with Python and FastAPI, it exposes a modern, auto-documented API that the frontend consumes. A core feature is its integration with NVIDIA's Data Synthesizer for generating realistic, high-quality data, with Ollama serving as a local backup, ensuring robust development and testing capabilities.

## 2. Features

* **High-Performance API:** Built with FastAPI for asynchronous, high-speed request handling.
* **Synthetic Data Generation:** Utilizes NVIDIA Data Synthesizer for creating rich, contextual mock data. Features a fallback mechanism using a local Ollama instance.
* **Application Ownership Tracking:** Manages the lifecycle of application ownership, identifies orphaned applications, and logs all historical changes.
* **AI-Powered Suggestions:** Integrates with an AI module to generate intelligent recommendations for reassigning owners of orphaned applications.
* **Data Aggregation:** Ingests and processes data from various sources (e.g., CMDB, security scanners, HR systems) to provide a unified view.
* **Auto-Generated API Docs:** Leverages FastAPI's native support for OpenAPI and Swagger UI for interactive API documentation.

## 3. Technology Stack

The backend is built with a modern, Python-centric, and AI-ready technology stack:

* **Runtime:** Python 3.10+
* **Framework:** FastAPI
* **Data Generation:** NVIDIA Data Synthesizer
* **Backup LLM:** Ollama
* **Database:** PostgreSQL with SQLAlchemy ORM
* **Database Migrations:** Alembic
* **API Specification:** OpenAPI (auto-generated by FastAPI)
* **Linting & Formatting:** Black, Flake8

## 4. Prerequisites

Before you begin, ensure you have the following installed on your local development machine:

* [Python](https://www.python.org/) (v3.10 or later) & pip
* A running instance of [PostgreSQL](https://www.postgresql.org/)
* [NVIDIA GPU](https://developer.nvidia.com/cuda-gpus) with appropriate drivers and CUDA toolkit (for NVIDIA Data Synthesizer)
* [Ollama](https://ollama.com/) installed and running locally.

## 5. Getting Started

Follow these steps to get the backend server running on your local machine.

**1. Clone the repository:**

```bash
git clone <your-repository-url>
cd <repository-folder>/backend
```

**2. Create and activate a virtual environment:**

```bash
python -m venv venv
source venv/bin/activate
# On Windows, use: venv\Scripts\activate
```

**3. Install dependencies:**

```bash
pip install -r requirements.txt
```

**4. Set up environment variables:**
Create a `.env` file in the root of the `/backend` directory. Copy the contents of `.env.example` into it and fill in the required values.

```env
# .env
DATABASE_URL="postgresql://user:password@localhost:5432/asset_management"
OLLAMA_HOST="http://localhost:11434"
# Add any NVIDIA API keys or specific model configs if required
```

**5. Run database migrations:**
(This assumes Alembic is configured)

```bash
alembic upgrade head
```

**6. Start the development server:**

```bash
uvicorn src.main:app --reload
```

The server should now be running on `http://localhost:8000`. You can access the interactive API documentation at `http://localhost:8000/docs`.

## 6. API Endpoints

The following are the primary endpoints provided by the backend.

### Application Ownership

* `GET /api/applications`
    * **Description:** Retrieves a list of all applications with optional filtering.
    * **Query Params:** `status`, `businessUnit`, `search`
* `GET /api/applications/:id`
    * **Description:** Retrieves a single application by its ID.
* `POST /api/applications/:id/assign`
    * **Description:** Assigns or reassigns an owner to an application.
    * **Body:** `{ "ownerId": "user-123" }`

### Ownership History

* `GET /api/history`
    * **Description:** Retrieves the complete ownership change history across all applications.

### AI Suggestions

* `GET /api/suggestions/orphaned`
    * **Description:** Retrieves AI-powered owner suggestions for all orphaned applications.

## 7. Project Structure

The backend follows a standard FastAPI project structure to maintain separation of concerns.

```
/backend
├── src/
│   ├── api/
│   │   └── v1/
│   │       ├── endpoints/  # Route definitions (e.g., applications.py)
│   │       └── schemas/    # Pydantic models for request/response
│   ├── core/
│   │   └── config.py     # Environment variables and settings
│   ├── db/
│   │   ├── models/       # SQLAlchemy ORM models
│   │   └── session.py    # Database session management
│   ├── services/           # Business logic, integrations with NVIDIA/Ollama
│   └── main.py             # FastAPI app entry point
├── alembic/                # Alembic migration scripts
├── tests/                  # Unit and integration tests
├── .env.example
├── requirements.txt
└── alembic.ini
```

## 8. Linting and Formatting

To maintain code quality and consistency, we use Black for code formatting and Flake8 for linting.

* **Check for linting errors:** `flake8 src`
* **Format code:** `black src`

These checks can be integrated into a pre-commit hook for automated enforcement.
